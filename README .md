# Flask 2048 增强版（毒格子 / 倒计时 / 撤回 / 成就）

一个基于 **Flask** 的 2048 Web 小游戏：完整实现经典移动/合并与随机生成逻辑，并加入一些“有点坏又有点好玩”的机制——**撤回一步**、**毒格子**、**倒计时格子**、**成就系统**与**统计面板**。

> 操作方式：键盘方向键 / 页面方向按钮均可。

---

## 功能亮点

- ✅ 经典 2048：上下左右移动、同值合并、随机生成 `2/4`  
- ↩️ 撤回一步：最多保存最近 **20** 步（可配置）
- ☠️ 毒格子（红色描边）：格子里的数字如果**连续若干步保持不变**，会被清零并解除毒性
- ⏳ 倒计时格子（蓝色描边）：只要格子有数字，每一步都会**数值减半**，减到 0 自动失效
- 🏆 成就系统：从 `64` 一路到 `8192`，弹窗提示 + 已解锁徽章展示
- 📊 数据统计：最高分、最大数字、步数、计时，以及总局数/平均分/平均步数等

---

## 快速开始

### 1) 准备环境

- Python 3.8+（建议）
- 依赖：Flask

安装依赖：

```bash
pip install flask
```

### 2) 放置文件结构

Flask 默认会在 `templates/` 目录下寻找模板文件。请确认 `index.html` 位于：

```text
.
├── app.py
├── game2048.py
└── templates/
    └── index.html
```

> 如果你当前的 `index.html` 在根目录，创建 `templates/` 并把它移动进去即可。

### 3) 启动

```bash
python app.py
```

浏览器打开：

```text
http://127.0.0.1:5000
```

---

## 玩法说明（新增机制）

### 撤回一步
点击“撤回一步”即可回到上一步的棋盘与分数状态（最多保留最近 20 步）。

### 毒格子（红色描边）
- 新生成的数字有一定概率被标记为 **毒格子**
- 如果该格子数字 **连续 N 步不变化**：该格子数字会被清零，并取消毒性  
  （N 默认是 5，可在 `app.py` 里改）

### 倒计时格子（蓝色描边）
- 新生成的数字有一定概率被标记为 **倒计时格子**
- 每走一步，该格子的数值都会 **`// 2`**  
- 数值减到 0 后，该格子不再是倒计时格

---

## 可配置参数

在 `app.py` 顶部可以调这些“游戏宇宙常数”：

- `MAX_HISTORY`：撤回历史长度（默认 20）
- `POISON_STEPS_LIMIT`：毒格子“停留不变”的步数阈值（默认 5）
- `POISON_CHANCE`：新生成数字成为毒格子的概率（默认 0.10）
- `COUNTDOWN_CHANCE`：新生成数字成为倒计时格子的概率（默认 0.10）
- `ACHIEVEMENTS`：成就阈值与名称

---

## 项目结构

```text
.
├── app.py               # Flask 路由与状态管理（session）
├── game2048.py          # 2048 核心逻辑：移动/合并/生成/判定
└── templates/
    └── index.html       # 界面模板（含样式与少量 JS）
```

---

## 一些注意事项（很现实但很重要）

- `app.py` 里有 `SECRET_KEY`，请在正式使用前替换成随机字符串。
- 本项目把棋盘与“撤回历史”等状态存进 Flask `session`。如果你使用的是 **默认 cookie session**，数据量可能会偏大（尤其是撤回步数较多时）。
  - 想玩得更稳：可以把 `MAX_HISTORY` 调小，或引入服务端 session（例如 Flask-Session + Redis/文件系统）。

---

## 可改进点（欢迎开脑洞）

- 添加动画（合并/出现）
- 加入排行榜（服务端持久化）
- 手机触屏滑动支持
- 多难度：不同棋盘大小 / 不同概率参数预设

---

## License

个人学习/展示用途随意使用；如需开源发布，建议补充一个明确的 License（MIT / Apache-2.0 等）。
